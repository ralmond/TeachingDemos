---
title: "IRT Models"
author: "Russell Almond"
date: "10/5/2021"
output: 
  html:
    sidebar: id-measure
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(shinyjs)
library(CPTtools)
library(arm)
```

## 4PL


$$ p(X|\theta_i,a_j, b_j, c_j, d_j) = c_j + (1-c_j-d_j)\text{logit}^{-1} \left ( 1.7 a_j(\theta_i - b_j) \right ) \qquad \theta_i \sim N(0,1) $$

```{r 4PL, echo=FALSE}

inputPanel(
  sliderInput("difficulty4", label = "Difficulty",
              min=-3.0, max=3.0, value=0, step=.1),
  
  sliderInput("discrimination4", label = "Discrimination:",
              min = 0.05, max = 2, value = 1, step = 0.05),
  sliderInput("guessing4",label="Guessing", min=0, max=.5, value=.25, step=.01),
  sliderInput("slipping4",label="Slipping", min=0, max=.5, value=.05, step=.01),
sliderInput("master4", label = "Mastery Point",
              min=-3.0, max=3.0, value=0, step=.1)  
)

renderPlot({
  c <- as.numeric(input$guessing4)
  d <- as.numeric(input$slipping4)
 curve(c+(1-c-d)*invlogit(1.7*input$discrimination4*(
   x-input$difficulty4)),xlim=c(-3.25,3.25),
   ylab="Probability of Success", xlab="Ability",
   main=paste("IRT Curve; difficulty = ",
              input$difficulty4,
              ", discrimination =", input$discrimination4,
              ", guessing=",input$guessing4,", slipping=",input$slipping4),
   ylim=c(0,1))
 abline(v=input$master4)
              
})


```


